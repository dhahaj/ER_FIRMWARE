<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <title>ER EExER Firmware by dhahaj</title>
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">ER EExER Firmware</h1>
      <h2 class="project-tagline">&nbsp;- Revision 5.2</h2>
      <a href="https://github.com/dhahaj/ER_FIRMWARE" class="btn">View on GitHub</a>
      <a href="https://github.com/dhahaj/ER_FIRMWARE/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/dhahaj/ER_FIRMWARE/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
<pre><br>
<main><h1>PS82/PS85 ER FIRMWARE</h1></main>

1/27/2017:<wbr>
 <i>TODO:</i> - modify the preprocessor code to keeep the interrupt code and instean use the preprocessor to turn off the 
         pin change interrupts on certain pins.

<h3>REVISION HISTORY:</h3><ul><li>8/21/2014: Release candidate version 5.1</li>
<li>9/13/2015: Rev 5.2 to fix a bug in the timing code found from DVPR1 testing</ul>
<h3>Compilation Info:</h3> Define a symbol named EExER with a value of 1 to compile the code for the EExER build version.
 Set the value to 0 to build the standard ER build version.
<h3>Build Versions:</h3> <b>*EExER*</b> - This build essentially removes most of the features found in the ER code as it is not required.
           More specifically, no DIP setting features and trigger Relay1 before triggering the rest of the outputs.
    <b>*ER*</b> - This version is compiled to be the standard ER firmware with the ability to use the entire feature set 
	   (e.g. the DIP switch settings). It allows for Dependent/Independent operation on dual doors, 
	   active high/low outputs, and toggling features. The DIP switches are interrupt driven so changes are implemented
	   immediately and the system auto adjusts depending on its current state. The order of events upon a trigger event is 
	   as stated below. 
<h3>Mode Definitions:</h3>   *Dependent Mode:* (IN1|IN2) &rarr; (DR<sub>1</sub> ACTIVE)&rarr;(DELAY 0.5s)&rarr;(DR2 ACTIVE)&rarr;(DELAY 0.5s)&rarr;(RLY1 & RLY2)&rarr;(DELAY DS1)&rarr;(RETURN)
   *Independent Mode:* (INx) &rarr; (DRx ACTIVE)&rarr;(DELAY 0.5s)&rarr;(RLYx)&rarr;(DELAY DSn)&rarr;(RETURN)
     <em><u>Operation in independent mode also requires the monitoring of the opposing door input during the delay time so that a</u>
     <u>triggering event is not missed. This is accomplished by controlling the timing and outputs outputs within the Timer1</u>
     <u>Compare Interrupt Service Routine Vector (see interrupts.c).</em></u>

<h2>*EExER*</h2> - This version is compiled for compatibility with the current delayed egress used in the 85-800.
   The pre-compiler bypasses all the DIP switch features as the delayed egress board controls the 
   outputs. This version does not populate the DIP switch (DIP1) or Door 2 rotary encoder (DS2) as 
   neither of these features will be used in this configuration.
   
 - The order of events when a trigger event occurs is as follows:
    <em>(IN1|IN2) &rarr; (RLY1)&rarr;(DELAY 0.5s)&rarr;(DR1 ACTIVE)&rarr;(DELAY 0.5s)&rarr;(DR2 ACTIVE)&rarr;(DELAY 0.5s)&rarr;(RLY2)&rarr;(DELAY DS1)&rarr;(RETURN).</em>
	
<b>Microcontroller:</b> Attiny88-AU MCU, TQFP 32A Package.
<strong>Datasheets:</strong> <a href="http://www.atmel.com/Images/doc8008.pdf">Complete</a>, <a href="http://www.atmel.com/Images/8008S.pdf">Summary</a>
<strong>AVR Toolchain Source Download:</strong> <a href="http://distribute.atmel.no/tools/opensource/Atmel-AVR-Toolchain-3.4.2/">AVR Toolchain</a>

<strong>Fuse Settings:</strong><ol style="list-style-type:square"><li>SPI Enabled, WD Timer Enabled, System Clock Divided by 8, Brownout Detection @ 2.7V, Internal Oscillator set to 8MHz with 64ms Start Delay.</li><li>Extended =<b> 0xFF</b></li><li>High     = <b>0xCD</b></li><li>Low      = <b>0x6E</b></li></ol>
<i>**TODO: Implement self testing features or write separate code for system testing for quality assurance.**  
*This software was developed using Atmel Studio 7.0 IDE and compiled with the bundled AVR toolchain.</i>
</pre>

<footer class="site-footer">
<span class="site-footer-owner"><a href="https://github.com/dhahaj/ER_FIRMWARE">Er firmware</a> is maintained by <a href="https://github.com/dhahaj">dhahaj</a>.</span>
<span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
</footer>

</section>

</body>
</html>
